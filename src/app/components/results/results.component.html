<div class="result-container">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-12 col-lg-10">
        <div class="card result-main-card shadow border-0">

          <!-- Result Header -->
          <div class="result-header">
            <h1>{{ selectedCategory | titlecase }} Quiz Results</h1>
          </div>

          <div class="result-content">
            <!-- Risultati del Quiz -->
            <div class="quiz-results">
              <h3>{{ getScoreMessage() }}</h3>

              <div class="score-summary mb-0 mt-0">
                <div class="score-item">
                  <strong>Correct Answers:</strong> {{ correctAnswers }} / {{ questions.length }}
                </div>
                <div class="score-item">
                  <strong>Final Score:</strong> {{ finalScore }} points
                </div>
                <div class="score-item">
                  <strong>Remaining Time:</strong> {{ (remainingTime * 1000) | date:'mm:ss':'UTC' }}
                </div>
                <div class="score-actions">
                  <button type="button" class="btn btn-light" (click)="saveScore()" [disabled]="scoreSaved">
                    {{ scoreSaved ? 'Score Saved!' : 'Save Score' }}
                  </button>
                </div>
              </div>

              <!-- Revisione Risposte -->
              <div class="answers-review mt-4 mb-0">
                <h2>Answers review:</h2>
                @for (question of questions; track question.id; let i = $index) {
                <div class="question-review">
                  <h4>Question {{ i + 1 }}: {{ question.question }}</h4>

                  <div class="review-options">
                    @for (option of question.options; track $index; let optionIndex = $index) {
                    <div class="review-option" [ngClass]="{
                        'correct': optionIndex === question.correctOptionIndex,
                        'wrong': optionIndex === question.currentAnswer && !isAnswerCorrect(i)
                      }">
                      {{ option }}
                      @if (optionIndex === question.correctOptionIndex) {
                      <span class="correct-label">(Correct)</span>
                      }
                      @if (optionIndex === question.currentAnswer && !isAnswerCorrect(i)) {
                      <span class="wrong-label">(Your answer)</span>
                      }
                    </div>
                    }
                  </div>
                </div>
                }
              </div>

              <!-- Azioni Finali -->
              <div class="final-actions">
                <button type="button" class="btn btn-light" (click)="viewCategoryLeaderboard()">
                  {{ selectedCategory | titlecase }} Leaderboard
                </button>
                <button type="button" class="btn btn-light" (click)="restartQuiz()">
                  Restart Quiz
                </button>
                <button type="button" class="btn btn-light" (click)="goBackToCategories()">
                  Back to Categories
                </button>
              </div>

            </div>
          </div>

        </div>
      </div>
    </div>
  </div>
</div>